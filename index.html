<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gray Guess</title>
    <style>
        html, body { margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: sans-serif; background-color: #ccc; }
        body { display: flex; flex-direction: column; }
        #squares, #buttons { display: flex; flex: 1; /* Make squares and buttons areas equal height */ }
        #sq1, #sq2, #btnEqual, #btnNotEqual {
            flex: 1; /* Each takes half the width of its container */
            display: flex; /* Needed for potential centering if content added */
            justify-content: center; /* Center content horizontally */
            align-items: center; /* Center content vertically */
        }
        #btnEqual, #btnNotEqual {
            font-size: 5vh; /* Large font size relative to viewport height */
            cursor: pointer;
            border: none; /* No button border */
            -webkit-tap-highlight-color: transparent; /* Remove tap highlight on mobile */
             background-color: #e0e0e0; /* Default button background */
             border-top: 1px solid #aaa; /* Slight separator */
        }
         #btnEqual:active, #btnNotEqual:active {
             background-color: #bdbdbd; /* Darker on press */
         }
        #info {
            padding: 5px 0;
            text-align: center;
            font-size: 0.9em;
            background-color: #eee;
            flex-shrink: 0; /* Prevent info area from shrinking */
            border-top: 1px solid #aaa;
        }
    </style>
</head>
<body>
    <div id="squares">
        <div id="sq1"></div>
        <div id="sq2"></div>
    </div>
    <div id="buttons">
        <button id="btnEqual">=</button>
        <button id="btnNotEqual">≠</button> <!-- ≠ is the 'not equal' symbol -->
    </div>
    <div id="info">--</div>

    <script>
        const sq1 = document.getElementById('sq1');
        const sq2 = document.getElementById('sq2');
        const btnEqual = document.getElementById('btnEqual');
        const btnNotEqual = document.getElementById('btnNotEqual');
        const info = document.getElementById('info');

        let gray1, gray2;
        let areEqual;
        let correctGuesses = 0;
        let totalGuesses = 0;

        function nextRound() {
            // 1. Choose base gray
            gray1 = Math.floor(Math.random() * 256);

            // 2. Decide if the other is equal or different (50% chance)
            const shouldBeEqual = Math.random() < 0.5;

            if (shouldBeEqual) {
                gray2 = gray1;
                areEqual = true;
            } else {
                areEqual = false;
                // Calculate 1% delta (must be at least 1)
                const delta = Math.max(1, Math.round(gray1 * 0.01));
                const min = Math.max(0, gray1 - delta);
                const max = Math.min(255, gray1 + delta);

                // Pick a random gray in the range, *excluding* gray1
                let attempts = 0; // Safety break
                do {
                    gray2 = Math.floor(Math.random() * (max - min + 1)) + min;
                    attempts++;
                } while (gray2 === gray1 && attempts < 50); // Ensure difference, prevent infinite loop if min=max=gray1 (shouldn't happen with delta>=1)

                // Fallback if somehow still equal (highly unlikely with delta>=1)
                 if (gray2 === gray1) {
                    if (gray1 > 0) gray2 = gray1 - 1;
                    else gray2 = gray1 + 1; // Ensure it's different
                 }
            }

            // 3. Apply colors
            sq1.style.backgroundColor = `rgb(${gray1},${gray1},${gray1})`;
            sq2.style.backgroundColor = `rgb(${gray2},${gray2},${gray2})`;

            // 4. Clear previous result message but keep stats
            updateInfo("--");
        }

        function updateInfo(message) {
             const percentage = totalGuesses === 0 ? 0 : Math.round((correctGuesses / totalGuesses) * 100);
             info.textContent = `${message} | Vals: ${gray1}, ${gray2} | Correct: ${percentage}% (${correctGuesses}/${totalGuesses})`;
        }

        function handleGuess(guessedEqual) {
            totalGuesses++;
            const correct = (guessedEqual === areEqual);
            let resultMsg;

            if (correct) {
                correctGuesses++;
                resultMsg = "Correct!";
            } else {
                resultMsg = "Incorrect.";
            }

            updateInfo(resultMsg);
            // Delay starting next round slightly to allow user to see result/values
            setTimeout(nextRound, 1000);
        }

        btnEqual.addEventListener('click', () => handleGuess(true));
        btnNotEqual.addEventListener('click', () => handleGuess(false));

        // Initial round
        nextRound();
    </script>
</body>
</html>
