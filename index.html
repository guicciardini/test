<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Gray Guess</title>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: sans-serif;
            overflow: hidden; /* Prevent scrollbars */
            background-color: #f0f0f0; /* Fallback background */
        }
        #container {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
        }
        #squares, #buttons {
            display: flex;
            flex: 1; /* Each takes half the vertical space */
            width: 100%;
        }
        #sq1, #sq2, #btn-equal, #btn-notequal {
            flex: 1; /* Each takes half the horizontal space within its container */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3em; /* Large text/symbol */
            font-weight: bold;
            border: none; /* No borders */
            padding: 0;
            margin: 0;
            box-sizing: border-box; /* Include padding/border in element's total width/height */
            -webkit-tap-highlight-color: transparent; /* Remove tap highlight on mobile */
        }
        #sq1, #sq2 {
             /* Backgrounds set by JS */
        }
        #btn-equal, #btn-notequal {
            cursor: pointer;
            background-color: #e0e0e0;
            color: #333;
        }
        #btn-equal:active, #btn-notequal:active {
            background-color: #cccccc; /* Basic feedback on press */
        }
        #info {
            position: absolute; /* Overlay info */
            bottom: 50%; /* Position just above buttons */
            left: 0;
            width: 100%;
            text-align: center;
            padding: 5px 0;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 0.9em;
            pointer-events: none; /* Allow clicks through to buttons */
            visibility: hidden; /* Hidden initially */
            z-index: 10;
        }
        #info span {
             display: block; /* Stack info lines */
             line-height: 1.3;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="squares">
            <div id="sq1"></div>
            <div id="sq2"></div>
        </div>
        <div id="buttons">
            <button id="btn-equal">=</button>
            <button id="btn-notequal">â‰ </button>
        </div>
    </div>

    <div id="info">
        <span id="result"></span>
        <span id="values"></span>
        <span id="score">Score: 0.0% (0/0)</span>
    </div>

    <script>
        const sq1 = document.getElementById('sq1');
        const sq2 = document.getElementById('sq2');
        const btnEqual = document.getElementById('btn-equal');
        const btnNotEqual = document.getElementById('btn-notequal');
        const infoDiv = document.getElementById('info');
        const resultSpan = document.getElementById('result');
        const valuesSpan = document.getElementById('values');
        const scoreSpan = document.getElementById('score');

        let gray1Value = 0;
        let gray2Value = 0;
        let areEqual = false;
        let correctGuesses = 0;
        let totalGuesses = 0;

        function setGray(element, grayValue) {
            element.style.backgroundColor = `rgb(${grayValue}, ${grayValue}, ${grayValue})`;
        }

        function generateGrays() {
            infoDiv.style.visibility = 'hidden'; // Hide info for new round

            gray1Value = Math.floor(Math.random() * 256); // 0-255

            // 50% chance to be equal
            if (Math.random() < 0.5) {
                gray2Value = gray1Value;
                areEqual = true;
            } else {
                const delta = Math.max(1, Math.round(gray1Value * 0.01));
                const min = Math.max(0, gray1Value - delta);
                const max = Math.min(255, gray1Value + delta);

                // Pick a different value within the range
                do {
                    // Ensure range has more than one value if possible
                    if (min === max) {
                         // This happens only if gray1=0, delta=0 OR gray1=255, delta=0
                         // But delta is Math.max(1, ...) so it's always at least 1
                         // This case should theoretically not be reachable with delta >= 1
                         // If somehow min=max, force inequality (e.g. if gray1=0, pick 1)
                         gray2Value = (gray1Value === 0) ? 1 : gray1Value -1;
                         if (gray2Value < 0 || gray2Value > 255) gray2Value = (gray1Value === 255) ? 254 : gray1Value + 1; // Fallback if -1 is invalid
                    } else {
                        gray2Value = Math.floor(Math.random() * (max - min + 1)) + min;
                    }
                } while (gray2Value === gray1Value); // Ensure they are actually different
                areEqual = false;
            }

            setGray(sq1, gray1Value);
            setGray(sq2, gray2Value);
        }

        function handleGuess(userGuessedEqual) {
            totalGuesses++;
            const correct = (userGuessedEqual === areEqual);

            if (correct) {
                correctGuesses++;
                resultSpan.textContent = "Correct!";
                resultSpan.style.color = '#7FFF7F'; // Light green
            } else {
                resultSpan.textContent = "Incorrect!";
                resultSpan.style.color = '#FF7F7F'; // Light red
            }

            valuesSpan.textContent = `Grays: ${gray1Value}, ${gray2Value}`;
            const percentage = totalGuesses === 0 ? 0 : (correctGuesses / totalGuesses * 100);
            scoreSpan.textContent = `Score: ${percentage.toFixed(1)}% (${correctGuesses}/${totalGuesses})`;

            infoDiv.style.visibility = 'visible';

            // Generate next pair immediately after showing result
            generateGrays();
        }

        btnEqual.onclick = () => handleGuess(true);
        btnNotEqual.onclick = () => handleGuess(false);

        // Initial setup
        generateGrays();
    </script>
</body>
</html>
